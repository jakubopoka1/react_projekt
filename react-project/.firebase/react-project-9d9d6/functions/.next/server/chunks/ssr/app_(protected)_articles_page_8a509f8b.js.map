{"version":3,"sources":["../../../../app/%28protected%29/articles/page.js"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useAuth } from \"@/app/lib/AuthContext\";\nimport { db } from \"@/app/lib/firebase\";\nimport {\n\taddDoc,\n\tcollection,\n\tgetDocs,\n\tquery,\n\twhere,\n\tserverTimestamp,\n} from \"firebase/firestore\";\n\nexport default function ArticlesPage() {\n\tconst { user } = useAuth();\n\n\tconst [items, setItems] = useState([]);\n\tconst [loading, setLoading] = useState(true);\n\n\tconst [title, setTitle] = useState(\"\");\n\tconst [error, setError] = useState(\"\");\n\tconst [msg, setMsg] = useState(\"\");\n\n\tconst load = async () => {\n\t\tif (!user?.uid) return;\n\n\t\tsetLoading(true);\n\t\tsetError(\"\");\n\n\t\ttry {\n\t\t\tconst q = query(\n\t\t\t\tcollection(db, \"articles\"),\n\t\t\t\twhere(\"user\", \"==\", user.uid)\n\t\t\t);\n\t\t\tconst snap = await getDocs(q);\n\t\t\tsetItems(snap.docs.map((d) => ({ id: d.id, ...d.data() })));\n\t\t} catch (e) {\n\t\t\tsetError(e?.message || \"Nie udało się pobrać artykułów.\");\n\t\t} finally {\n\t\t\tsetLoading(false);\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tload();\n\t}, [user?.uid]);\n\n\tconst onAdd = async (e) => {\n\t\te.preventDefault();\n\t\tsetError(\"\");\n\t\tsetMsg(\"\");\n\n\t\tif (!title.trim()) {\n\t\t\tsetError(\"Podaj tytuł.\");\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tawait addDoc(collection(db, \"articles\"), {\n\t\t\t\ttitle: title.trim(),\n\t\t\t\tuser: user.uid,\n\t\t\t\tcreatedAt: serverTimestamp(),\n\t\t\t});\n\n\t\t\tsetTitle(\"\");\n\t\t\tsetMsg(\"Dodano artykuł.\");\n\t\t\tawait load();\n\t\t} catch (e) {\n\t\t\tsetError(e?.message || \"Nie udało się dodać artykułu.\");\n\t\t}\n\t};\n\n\tif (loading) {\n\t\treturn (\n\t\t\t<div className='p-6'>\n\t\t\t\t<span className='loading loading-spinner loading-md'></span>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div className='max-w-2xl'>\n\t\t\t<div className='flex items-center justify-between mb-4'>\n\t\t\t\t<h1 className='text-2xl font-bold'>My articles</h1>\n\t\t\t\t<div className='badge badge-neutral'>{items.length}</div>\n\t\t\t</div>\n\n\t\t\t{error && (\n\t\t\t\t<div className='alert alert-error mb-4'>\n\t\t\t\t\t<span>{error}</span>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{msg && (\n\t\t\t\t<div className='alert alert-success mb-4'>\n\t\t\t\t\t<span>{msg}</span>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t<div className='card bg-base-100 shadow border border-base-300 mb-6'>\n\t\t\t\t<div className='card-body p-4'>\n\t\t\t\t\t<h2 className='card-title text-base'>Add article</h2>\n\n\t\t\t\t\t<form onSubmit={onAdd} className='flex flex-col gap-3 sm:flex-row'>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclassName='input input-bordered w-full'\n\t\t\t\t\t\t\tplaceholder='Title'\n\t\t\t\t\t\t\tvalue={title}\n\t\t\t\t\t\t\tonChange={(e) => setTitle(e.target.value)}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<button className='btn btn-primary sm:w-32' type='submit'>\n\t\t\t\t\t\t\tAdd\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{items.length === 0 ? (\n\t\t\t\t<div className='card bg-base-100 shadow border border-base-300'>\n\t\t\t\t\t<div className='card-body p-4'>\n\t\t\t\t\t\t<div className='text-sm opacity-70'>Brak rekordów.</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t) : (\n\t\t\t\t<div className='grid gap-3'>\n\t\t\t\t\t{items.map((x) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tkey={x.id}\n\t\t\t\t\t\t\tclassName='card bg-base-100 shadow border border-base-300'>\n\t\t\t\t\t\t\t<div className='card-body p-4'>\n\t\t\t\t\t\t\t\t<div className='flex items-start justify-between gap-3'>\n\t\t\t\t\t\t\t\t\t<div className='min-w-0'>\n\t\t\t\t\t\t\t\t\t\t<div className='font-semibold truncate'>\n\t\t\t\t\t\t\t\t\t\t\t{x.title ?? x.id}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div className='text-xs opacity-60'>ID: {x.id}</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className='badge badge-outline'>article</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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"}