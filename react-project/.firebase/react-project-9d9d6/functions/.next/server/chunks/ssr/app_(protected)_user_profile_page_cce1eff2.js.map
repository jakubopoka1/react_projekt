{"version":3,"sources":["../../../../app/%28protected%29/user/profile/page.js"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { updateProfile } from \"firebase/auth\";\nimport { useAuth } from \"@/app/lib/AuthContext\";\nimport { db } from \"@/app/lib/firebase\";\nimport { setDoc, doc, getDoc } from \"firebase/firestore\";\n\nexport default function ProfilePage() {\n\tconst { user } = useAuth();\n\n\tconst [error, setError] = useState(\"\");\n\tconst [msg, setMsg] = useState(\"\");\n\n\tconst [addrLoading, setAddrLoading] = useState(true);\n\tconst [address, setAddress] = useState({\n\t\tstreet: \"\",\n\t\tcity: \"\",\n\t\tzipCode: \"\",\n\t});\n\n\tuseEffect(() => {\n\t\tconst loadAddress = async () => {\n\t\t\tif (!user?.uid) {\n\t\t\t\tsetAddrLoading(false);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetAddrLoading(true);\n\t\t\tsetError(\"\");\n\n\t\t\ttry {\n\t\t\t\tconst snap = await getDoc(doc(db, \"users\", user.uid));\n\t\t\t\tconst a = snap.exists() ? snap.data()?.address : null;\n\n\t\t\t\tif (a) {\n\t\t\t\t\tsetAddress({\n\t\t\t\t\t\tstreet: a.street || \"\",\n\t\t\t\t\t\tcity: a.city || \"\",\n\t\t\t\t\t\tzipCode: a.zipCode || \"\",\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tsetAddress({ street: \"\", city: \"\", zipCode: \"\" });\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsetError(e?.message || \"Nie udało się pobrać danych adresowych.\");\n\t\t\t} finally {\n\t\t\t\tsetAddrLoading(false);\n\t\t\t}\n\t\t};\n\n\t\tloadAddress();\n\t}, [user?.uid]);\n\n\tconst onSubmit = async (e) => {\n\t\te.preventDefault();\n\t\tsetError(\"\");\n\t\tsetMsg(\"\");\n\n\t\tconst displayName = e.target.displayName.value;\n\t\tconst photoURL = e.target.photoURL.value;\n\n\t\ttry {\n\t\t\tawait updateProfile(user, { displayName, photoURL });\n\n\t\t\tawait setDoc(\n\t\t\t\tdoc(db, \"users\", user.uid),\n\t\t\t\t{\n\t\t\t\t\taddress: {\n\t\t\t\t\t\tstreet: address.street,\n\t\t\t\t\t\tcity: address.city,\n\t\t\t\t\t\tzipCode: address.zipCode,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{ merge: true }\n\t\t\t);\n\n\t\t\tsetMsg(\"Profile updated\");\n\t\t} catch (err) {\n\t\t\tsetError(err?.message || \"Nie udało się zaktualizować profilu.\");\n\t\t}\n\t};\n\n\treturn (\n\t\t<div className='max-w-2xl'>\n\t\t\t<div className='flex items-center justify-between mb-4'>\n\t\t\t\t<h1 className='text-2xl font-bold'>Profile</h1>\n\t\t\t\t{user?.email && <div className='badge badge-neutral'>{user.email}</div>}\n\t\t\t</div>\n\n\t\t\t{error && (\n\t\t\t\t<div className='alert alert-error mb-4'>\n\t\t\t\t\t<span>{error}</span>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{msg && (\n\t\t\t\t<div className='alert alert-success mb-4'>\n\t\t\t\t\t<span>{msg}</span>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t<div className='card bg-base-100 shadow border border-base-300'>\n\t\t\t\t<div className='card-body p-6 gap-5'>\n\t\t\t\t\t<div className='flex items-center gap-4'>\n\t\t\t\t\t\t<div className='avatar'>\n\t\t\t\t\t\t\t<div className='w-16 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2'>\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc={\n\t\t\t\t\t\t\t\t\t\tuser?.photoURL || \"https://placehold.co/128x128?text=USER\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\talt='Profile'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className='min-w-0'>\n\t\t\t\t\t\t\t<div className='font-semibold text-lg truncate'>\n\t\t\t\t\t\t\t\t{user?.displayName || \"No display name\"}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className='text-sm opacity-70 truncate'>{user?.uid}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<form onSubmit={onSubmit} className='grid gap-3'>\n\t\t\t\t\t\t<div className='form-control'>\n\t\t\t\t\t\t\t<label className='label'>\n\t\t\t\t\t\t\t\t<span className='label-text'>Display name</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tname='displayName'\n\t\t\t\t\t\t\t\tdefaultValue={user?.displayName || \"\"}\n\t\t\t\t\t\t\t\tclassName='input input-bordered w-full'\n\t\t\t\t\t\t\t\tplaceholder='displayName'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className='form-control'>\n\t\t\t\t\t\t\t<label className='label'>\n\t\t\t\t\t\t\t\t<span className='label-text'>Email</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tname='email'\n\t\t\t\t\t\t\t\tvalue={user?.email || \"\"}\n\t\t\t\t\t\t\t\treadOnly\n\t\t\t\t\t\t\t\tclassName='input input-bordered w-full opacity-70'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className='form-control'>\n\t\t\t\t\t\t\t<label className='label'>\n\t\t\t\t\t\t\t\t<span className='label-text'>Photo URL</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tname='photoURL'\n\t\t\t\t\t\t\t\tdefaultValue={user?.photoURL || \"\"}\n\t\t\t\t\t\t\t\tclassName='input input-bordered w-full'\n\t\t\t\t\t\t\t\tplaceholder='photoURL'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className='divider my-1'>Address</div>\n\n\t\t\t\t\t\t<div className='grid grid-cols-1 md:grid-cols-3 gap-3'>\n\t\t\t\t\t\t\t<div className='form-control'>\n\t\t\t\t\t\t\t\t<label className='label'>\n\t\t\t\t\t\t\t\t\t<span className='label-text'>Street</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tname='street'\n\t\t\t\t\t\t\t\t\tvalue={address.street}\n\t\t\t\t\t\t\t\t\tonChange={(e) =>\n\t\t\t\t\t\t\t\t\t\tsetAddress({ ...address, street: e.target.value })\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdisabled={addrLoading}\n\t\t\t\t\t\t\t\t\tclassName='input input-bordered w-full'\n\t\t\t\t\t\t\t\t\tplaceholder='street'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className='form-control'>\n\t\t\t\t\t\t\t\t<label className='label'>\n\t\t\t\t\t\t\t\t\t<span className='label-text'>City</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tname='city'\n\t\t\t\t\t\t\t\t\tvalue={address.city}\n\t\t\t\t\t\t\t\t\tonChange={(e) =>\n\t\t\t\t\t\t\t\t\t\tsetAddress({ ...address, city: e.target.value })\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdisabled={addrLoading}\n\t\t\t\t\t\t\t\t\tclassName='input input-bordered w-full'\n\t\t\t\t\t\t\t\t\tplaceholder='city'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className='form-control'>\n\t\t\t\t\t\t\t\t<label className='label'>\n\t\t\t\t\t\t\t\t\t<span className='label-text'>Zip code</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tname='zipCode'\n\t\t\t\t\t\t\t\t\tvalue={address.zipCode}\n\t\t\t\t\t\t\t\t\tonChange={(e) =>\n\t\t\t\t\t\t\t\t\t\tsetAddress({ ...address, zipCode: e.target.value })\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdisabled={addrLoading}\n\t\t\t\t\t\t\t\t\tclassName='input input-bordered w-full'\n\t\t\t\t\t\t\t\t\tplaceholder='zipCode'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className='flex items-center justify-between mt-2'>\n\t\t\t\t\t\t\t{addrLoading ? (\n\t\t\t\t\t\t\t\t<div className='flex items-center gap-2 text-sm opacity-70'>\n\t\t\t\t\t\t\t\t\t<span className='loading loading-spinner loading-sm'></span>\n\t\t\t\t\t\t\t\t\tLoading address...\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<div className='text-sm opacity-60'>Ready</div>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclassName='btn btn-primary'\n\t\t\t\t\t\t\t\ttype='submit'\n\t\t\t\t\t\t\t\tdisabled={addrLoading}>\n\t\t\t\t\t\t\t\t{addrLoading ? \"Loading...\" : \"Zapisz\"}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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"}